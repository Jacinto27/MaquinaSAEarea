<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.165">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrés Gutiérrez">
<meta name="author" content="Stalyn Guerrero">
<meta name="dcterms.date" content="2023-02-27">

<title>Estimación de la tasa de informalidad en República Dominicana empleando modelos de área con transformación arcoseno</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="05 FHBench_files/libs/clipboard/clipboard.min.js"></script>
<script src="05 FHBench_files/libs/quarto-html/quarto.js"></script>
<script src="05 FHBench_files/libs/quarto-html/popper.min.js"></script>
<script src="05 FHBench_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="05 FHBench_files/libs/quarto-html/anchor.min.js"></script>
<link href="05 FHBench_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="05 FHBench_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="05 FHBench_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="05 FHBench_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="05 FHBench_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="05 FHBench_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="05 FHBench_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Estimación de la tasa de informalidad en República Dominicana empleando modelos de área con transformación arcoseno</h1>
<p class="subtitle lead">Benchmark regional para las estimaciones del modelo de área</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    Andrés Gutiérrez 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            CEPAL - Unidad de Estadísticas Sociales
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    Stalyn Guerrero 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            CEPAL - Unidad de Estadísticas Sociales
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 27, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="lectura-de-librerías" class="level2">
<h2 class="anchored" data-anchor-id="lectura-de-librerías">Lectura de librerías</h2>
<div class="cell" data-hash="0Recursos/05/unnamed-chunk-1_d5c33fc8a32c6cb850c8e8ba5949a0db">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(srvyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TeachingSampling)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sae)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emdi)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(odbc)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flexmix)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modeltools)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>id_dominio <span class="ot">&lt;-</span> <span class="st">"id_dominio"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lectura-de-bases-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="lectura-de-bases-de-datos">Lectura de bases de datos</h2>
<p>El código está leyendo varios archivos necesarios para el análisis.</p>
<ul>
<li><code>poligonos_dominios</code>: Es un archivo shapefile que contiene la información geográfica (polígonos) de los dominios de la encuesta. Se carga usando la función <code>read_sf()</code> del paquete <code>sf</code>.</li>
<li><code>base_completa</code>: Es un archivo RDS que contiene la información de la encuesta. Incluye información de los dominios, los estratos, los conglomerados y los pesos.</li>
<li><code>estimacionesPre</code>: Es un archivo RDS que contiene las estimaciones directas de los dominios.</li>
<li><code>base_FH</code>: Es una base que se crea al juntar la <code>base_completa</code> con las <code>estimacionesPre</code> usando la función <code>left_join()</code> del paquete <code>dplyr</code>.</li>
<li><code>encuesta</code>: Es un archivo RDS que contiene la información de la encuesta.</li>
<li><code>fh_arcsin</code>: Es un archivo RDS que contiene las estimaciones del modelo ajustado de Fay-Herriot.</li>
<li><code>personas_dominio</code>: Es un archivo RDS que contiene número de personas en cada dominio.</li>
<li><code>personas_dominio_agregado</code>: Es un archivo RDS que contiene el número total de personas agregada por región.</li>
</ul>
<div class="cell" data-hash="0Recursos/05/unnamed-chunk-2_55d34eb07c425c07a4713046cf140dd5">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Shapefile</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>poligonos_dominios <span class="ot">&lt;-</span> <span class="fu">read_sf</span>( <span class="st">"../shapefiles2010/DOM.shp"</span>) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Base de estimaciones </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>base_completa <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../Data/base_completa.Rds'</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>estimacionesPre <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../Data/estimaciones.Rds'</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>base_FH <span class="ot">&lt;-</span> <span class="fu">left_join</span>(base_completa, estimacionesPre,   <span class="at">by =</span> id_dominio)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Encuesta</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>encuesta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../Data/encuestaDOM.Rds"</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimaciones del modelo ajustado</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>fh_arcsin <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../Data/fh_arcsin.Rds"</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Agregados por dominios y región </span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>personas_dominio <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../Data/agregado_persona_dominio.rds'</span>) </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>personas_dominio_agregado <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'../Data/agregado_persona_region.rds'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimación-directa-por-región" class="level2">
<h2 class="anchored" data-anchor-id="estimación-directa-por-región">Estimación directa por región</h2>
<p>El código carga y prepara los datos de la encuesta y luego calcula las estimaciones directas en cada región del país.</p>
<p>Primero, para el conjunto de datos de la encuesta se utiliza la función <code>mutate()</code> de <code>dplyr</code> para agregar tres columnas: <code>upm</code>, <code>estrato</code> y <code>factor_anual</code>. La columna <code>upm</code> es la identificación única de la unidad primaria de muestreo, <code>estrato</code> es la identificación del estrato en el que se encuentra la unidad primaria de muestreo y <code>factor_anual</code> es el factor de expansión anual, calculado dividiendo el factor de expansión trimestral entre 4.</p>
<p>A continuación, se utiliza la función <code>as_survey_design()</code> de la librería <code>survey</code> para crear un objeto de diseño de la encuesta a partir de los datos. La función utiliza las columnas <code>estrato</code>, <code>upm</code> y <code>factor_anual</code> para especificar las estrategias de muestreo, el peso de muestreo y la estructura de conglomerados.</p>
<p>Por último, se utiliza la función <code>group_by()</code> de <code>dplyr</code> para agrupar los datos por <code>id_region</code>, luego se utiliza la función <code>summarise()</code> de <code>dplyr</code> junto con <code>survey_ratio()</code> de <code>survey</code> para calcular la estimación directa. El resultado se asigna a un objeto llamado <code>directoDepto</code>, que contiene las columnas <code>id_region</code> y <code>theta_region</code>, que corresponde a la estimación directa en cada región.</p>
<div class="cell" data-hash="0Recursos/05/unnamed-chunk-3_bf674a0abca00b3699bb90f05be8e143">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>encuesta <span class="ot">&lt;-</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  encuesta <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">upm =</span> <span class="fu">str_pad</span>(<span class="at">string =</span> upm,<span class="at">width =</span> <span class="dv">9</span>,<span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">estrato =</span> <span class="fu">str_pad</span>(<span class="at">string =</span> estrato,<span class="at">width =</span> <span class="dv">5</span>,<span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">factor_anual =</span> factor_expansion <span class="sc">/</span> <span class="dv">4</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>disenoDOM <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_survey_design</span>(</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">strata =</span> estrato,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ids =</span> upm,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">weights =</span> factor_anual,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">nest=</span>T</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>directoDepto <span class="ot">&lt;-</span> disenoDOM <span class="sc">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id_region) <span class="sc">%&gt;%</span> </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ocupado <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> pet <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Rd =</span> <span class="fu">survey_ratio</span>(</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">numerator =</span> orden_sector <span class="sc">==</span> <span class="dv">2</span> ,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">denominator =</span> <span class="dv">1</span>,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">vartype =</span> <span class="fu">c</span>(<span class="st">"se"</span>, <span class="st">"ci"</span>, <span class="st">"var"</span>, <span class="st">"cv"</span>),</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">deff =</span> T</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(id_region, <span class="at">theta_region =</span> Rd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="consolidación-de-la-base-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="consolidación-de-la-base-de-datos">Consolidación de la base de datos</h2>
<p>Este código realiza los siguientes pasos:</p>
<ul>
<li><p>Realiza un <code>left_join()</code> entre la tabla <code>directoDepto</code> y la tabla <code>personas_dominio</code> por la columna <code>id_region</code>.</p></li>
<li><p>Realiza un <code>left_join()</code> entre la tabla resultante del paso anterior y la tabla <code>personas_dominio_agregado</code> por la columna <code>id_region</code>. El resultado de esta unión es una tabla que agrega la información por dominio a nivel de región.</p></li>
<li><p>Realiza un <code>left_join()</code> entre la tabla resultante del paso anterior y la tabla <code>estimacionesPre</code> por la columna <code>id_dominio</code>. El resultado de esta unión es una tabla que agrega la información de ambas tablas por dominio.</p></li>
<li><p>Transmuta la columna <code>FayHerriot</code> de la tabla resultante del paso anterior y cambia su nombre a <code>FayHarriot</code>. El resultado final es una tabla llamada <code>R_mpio</code> que contiene información agregada por región y dominio, así como las estimaciones por dominio utilizando el método de Fay Herriot.</p></li>
</ul>
<div class="cell" data-hash="0Recursos/05/unnamed-chunk-4_b90f63dfb066a44c7738a8bd3a46fc2a">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>R_mpio <span class="ot">&lt;-</span> directoDepto <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(personas_dominio, <span class="at">by =</span> <span class="st">'id_region'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(personas_dominio_agregado, <span class="at">by =</span> <span class="st">"id_region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(estimacionesPre <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">transmute</span>(id_dominio, <span class="at">FayHerriot =</span> FH),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> id_dominio) <span class="sc">%&gt;%</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pesos-benchmark" class="level2">
<h2 class="anchored" data-anchor-id="pesos-benchmark">Pesos Benchmark</h2>
<p>Para obtener el factor multiplicador de de Benchmarking se ejecuta el código siguiente. El código está creando un objeto llamado <code>R_mpio2</code>, el cual se está construyendo a partir del objeto <code>R_mpio</code>. Primero, se agrupa por <code>id_region</code> usando <code>group_by()</code> y se calculan dos medidas de razón de la encuesta utilizando <code>summarise()</code>. Los cálculos de las medidas de razón no están claros ya que dependen de variables no presentes en el código. Luego, se realiza un <code>left_join()</code> con el objeto <code>directoDepto</code> para añadir la variable <code>theta_region</code>.</p>
<p>Posteriormente, se construye un objeto llamado pesos a partir del objeto <code>R_mpio</code> utilizando <code>ungroup()</code> para eliminar la agrupación anteriormente realizada. Luego, se añade la columna <code>W_i</code> que representa los pesos muestrales utilizados para el análisis.</p>
<p>La función <code>tba()</code> no está disponible en R base o en los paquetes <code>dplyr</code>, por lo que no es posible determinar lo que hace. Probablemente es una función personalizada por el autor del código.</p>
<div class="cell" data-hash="0Recursos/05/unnamed-chunk-5_8234e8f687de4040f53dc125e8e8c4e3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>R_mpio2 <span class="ot">&lt;-</span> R_mpio <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id_region) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">R_region_RB =</span> <span class="fu">unique</span>(theta_region) <span class="sc">/</span> <span class="fu">sum</span>((pp_dominio  <span class="sc">/</span> pp_region ) <span class="sc">*</span> FayHerriot),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">R_region_DB =</span> <span class="fu">unique</span>(theta_region) <span class="sc">-</span> <span class="fu">sum</span>((pp_dominio  <span class="sc">/</span> pp_region ) <span class="sc">*</span> FayHerriot)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(directoDepto, <span class="at">by =</span> <span class="st">"id_region"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>pesos <span class="ot">&lt;-</span> R_mpio <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">W_i =</span> pp_dominio <span class="sc">/</span> pp_region) <span class="sc">%&gt;%</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(id_dominio, W_i)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pesos, <span class="dv">15</span>) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> id_dominio </th>
   <th style="text-align:right;"> W_i </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0101 </td>
   <td style="text-align:right;"> 0.2890 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3201 </td>
   <td style="text-align:right;"> 0.2841 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3202 </td>
   <td style="text-align:right;"> 0.1088 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3203 </td>
   <td style="text-align:right;"> 0.1585 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3204 </td>
   <td style="text-align:right;"> 0.0425 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3205 </td>
   <td style="text-align:right;"> 0.0132 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3206 </td>
   <td style="text-align:right;"> 0.0817 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3207 </td>
   <td style="text-align:right;"> 0.0222 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0901 </td>
   <td style="text-align:right;"> 0.0554 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0902 </td>
   <td style="text-align:right;"> 0.0021 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0903 </td>
   <td style="text-align:right;"> 0.0115 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0904 </td>
   <td style="text-align:right;"> 0.0024 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1801 </td>
   <td style="text-align:right;"> 0.0489 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1802 </td>
   <td style="text-align:right;"> 0.0058 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1803 </td>
   <td style="text-align:right;"> 0.0020 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="estimación-fh-benchmark" class="level2">
<h2 class="anchored" data-anchor-id="estimación-fh-benchmark">Estimación FH Benchmark</h2>
<p>El siguiente código realiza una serie de operaciones sobre dos <code>data.frames</code>: <code>estimacionesPre</code> y <code>R_mpio</code> para obtener las estimaciones ajustadas mediante el benchmarking.</p>
<p>En primer lugar, se realiza un <code>left_join</code> entre <code>estimacionesPre</code> y <code>R_mpio</code> utilizando la columna <code>id_dominio</code>.</p>
<p>Luego, se realiza un nuevo <code>left_join</code> entre este <code>data.frame</code> resultante y <code>R_mpio2</code>, utilizando la columna <code>id_region</code>. Este join agrega las columnas <code>R_region_RB</code> y <code>R_region_DB</code> de <code>R_mpio2</code> al <code>data.frame()</code>.</p>
<p>A continuación, se calcula una nueva columna llamada <code>FH_RBench</code> que resulta de multiplicar la columna FH por la columna <code>R_region_RB</code>.</p>
<p>Por último, se realiza un join entre este <code>data.frame</code> resultante y pesos, utilizando la columna <code>id_dominio</code>. Este join agrega la columna <code>W_i</code> de <code>pesos</code> al <code>data.frame</code>. El resultado final se guarda en la variable <code>estimacionesBench</code>.</p>
<div class="cell" data-hash="0Recursos/05/unnamed-chunk-6_0eba8cab1e6da0b0b01749136c94d5f0">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>estimacionesBench <span class="ot">&lt;-</span> estimacionesPre <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(R_mpio <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(id_region, id_dominio), </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> id_dominio) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(R_mpio2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id_region"</span>)) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FH_RBench =</span> R_region_RB <span class="sc">*</span> FH) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pesos, <span class="at">by =</span> id_dominio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="validación-estimación-fh-con-benchmark" class="level3">
<h3 class="anchored" data-anchor-id="validación-estimación-fh-con-benchmark">Validación: Estimación FH con Benchmark</h3>
<p>Al realizar el proceso de validación notamos que las estimaciones con directas de las regiones y las estimaciones de FH con Benchmarking son iguales.</p>
<div class="cell" data-hash="0Recursos/05/unnamed-chunk-7_f90dc1971abba6f135f81af4d2d47712">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>estimacionesBench <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(id_region) <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">theta_reg_RB =</span> <span class="fu">sum</span>(W_i <span class="sc">*</span> FH_RBench)) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(directoDepto, <span class="at">by =</span> <span class="st">"id_region"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> id_region </th>
   <th style="text-align:right;"> theta_reg_RB </th>
   <th style="text-align:right;"> theta_region </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 01 </td>
   <td style="text-align:right;"> 0.4331 </td>
   <td style="text-align:right;"> 0.4331 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0.5231 </td>
   <td style="text-align:right;"> 0.5231 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 03 </td>
   <td style="text-align:right;"> 0.5566 </td>
   <td style="text-align:right;"> 0.5566 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 04 </td>
   <td style="text-align:right;"> 0.4685 </td>
   <td style="text-align:right;"> 0.4685 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="comparación-gráfica-entre-estimación-fh-y-fh-con-benchmark-por-dominio" class="level3">
<h3 class="anchored" data-anchor-id="comparación-gráfica-entre-estimación-fh-y-fh-con-benchmark-por-dominio">Comparación gráfica entre estimación FH y FH con Benchmark por dominio</h3>
<p>El código presentado realiza una comparación de las estimaciones Fay-Herriot originales con las estimaciones Fay-Herriot con benchmark.</p>
<div class="cell" data-hash="0Recursos/05/unnamed-chunk-8_eb7d37a30da776e4702e434220b1b9f4">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>temp_Bench <span class="ot">&lt;-</span> estimacionesBench <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    id_dominio,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Directo =</span> Direct <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">FayHerriot =</span> FH <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">FH_RBench =</span> FH_RBench <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    Gamma)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(temp_Bench, <span class="fu">aes</span>(FH_RBench, FayHerriot)) <span class="sc">+</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Estimación Fay-Herriot"</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Estimación Fay-Herriot con Benchmark"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/05/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="tabla-final-de-estimaciones" class="level2">
<h2 class="anchored" data-anchor-id="tabla-final-de-estimaciones">Tabla final de estimaciones</h2>
<section id="función-para-el-calculo-de-intervalos-de-confianza" class="level3">
<h3 class="anchored" data-anchor-id="función-para-el-calculo-de-intervalos-de-confianza">Función para el calculo de intervalos de confianza</h3>
<p>La función <code>ICL()</code> sirve para calcular intervalos de confianza para la proporción de una población, dada una muestra y un nivel de confianza. Los argumentos de la función son:</p>
<ul>
<li><code>p</code>: la proporción muestral</li>
<li><code>mse</code>: el error cuadrático medio</li>
<li><code>alpha</code>: el nivel de confianza deseado (por defecto es 0.05)</li>
<li><code>student</code>: un indicador booleano que indica si se debe usar una distribución t de Student en lugar de la distribución normal para el cálculo del intervalo de confianza (por defecto es FALSE)</li>
<li><code>nu</code>: el número de grados de libertad si se usa una distribución t de Student (por defecto es NULL y se calcula automáticamente)</li>
</ul>
<div class="cell" data-hash="0Recursos/05/unnamed-chunk-9_fc2e843d437e297e977e9f352913452c">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ICL <span class="ot">&lt;-</span> <span class="cf">function</span>(p, mse, <span class="at">alpha =</span> <span class="fl">0.05</span>, <span class="at">student =</span> <span class="cn">FALSE</span>, <span class="at">nu =</span> <span class="cn">NULL</span>) {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (student <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    q <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, nu)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    q <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  CL <span class="ot">&lt;-</span> <span class="fu">log</span>(p<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> p)) <span class="sc">-</span> (q <span class="sc">*</span> <span class="fu">sqrt</span>(mse))<span class="sc">/</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  CU <span class="ot">&lt;-</span> <span class="fu">log</span>(p<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> p)) <span class="sc">+</span> (q <span class="sc">*</span> <span class="fu">sqrt</span>(mse))<span class="sc">/</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  IC_1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(CL)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(CL))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  IC_2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(CU)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(CU))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">L.I =</span> IC_1, <span class="at">L.S =</span> IC_2))</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La función <code>TablaFinal</code> toma como entrada la tabla <code>estimacionesBench</code> y realiza una serie de transformaciones y cálculos para generar una tabla final con las estimaciones y los intervalos de confianza correspondientes.</p>
<p>Primero, agrega dos columnas nuevas: <code>sintetico</code> y <code>sintetico_back</code>. La columna <code>sintetico</code> se obtiene a partir de una matriz generada a partir de la columna <code>base_FH</code> de la tabla <code>estimacionesBench</code>, que contiene los valores de las variables auxiliares utilizadas en el modelo de Fay-Herriot. Esta matriz se multiplica por los coeficientes del modelo ajustado, que se asume que se ha generado previamente. La columna <code>sintetico_back</code> es el resultado de aplicar una transformación inversa al valor de <code>sintetico</code>.</p>
<p>Luego, se seleccionan y renombran las columnas que se incluirán en la tabla final. Estas columnas incluyen la estimación directa (<code>Directo</code>), el error estándar de la estimación directa (<code>ee_directo</code>), el coeficiente de variación de la estimación directa (<code>CV_directo</code>), la estimación de Fay-Herriot (<code>FayHerriot</code>), la raíz del error cuadrático medio de la estimación de Fay-Herriot (<code>rmse_FH</code>), el coeficiente de variación de la estimación de Fay-Herriot (<code>rrmse_FH</code>), la estimación de gamma (<code>Gamma</code>), las estimaciones sintéticas (<code>sintetico</code> y <code>sintetico_back</code>), la estimación de Fay-Herriot con el ajuste de benchmark (<code>FH_RBench</code>), y los límites inferior y superior de los intervalos de confianza calculados utilizando el método de la distribución normal (<code>LI_normal</code> y <code>LS_normal</code>) y el método logit (<code>LI_logit</code> y <code>LS_logit</code>). Finalmente, se calculan los límites inferior y superior de los intervalos de confianza finales (<code>LI_final</code> y <code>LS_final</code>), teniendo en cuenta los límites de 0 y 1.</p>
<div class="cell" data-hash="0Recursos/05/unnamed-chunk-10_5f97b1f8e5074849497fe1e2da5ee613">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>TablaFinal <span class="ot">&lt;-</span> estimacionesBench <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sintetico =</span> <span class="fu">as.matrix</span>(base_FH <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                            dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">rownames</span>(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                              fh_arcsin<span class="sc">$</span>model<span class="sc">$</span>coefficients</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                            ))) <span class="sc">%*%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>      fh_arcsin<span class="sc">$</span>model<span class="sc">$</span>coefficients[, <span class="dv">1</span>],</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sintetico_back =</span> <span class="fu">sin</span>(sintetico) <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    id_dominio,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_muestral =</span> n,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Directo =</span> Direct,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ee_directo =</span> <span class="fu">sqrt</span>(Direct_MSE),</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">CV_directo =</span> Direct_CV,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">FayHerriot =</span> FH,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">rmse_FH =</span> <span class="fu">sqrt</span>(FH_MSE),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">rrmse_FH =</span> rmse_FH <span class="sc">/</span> FayHerriot,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    Gamma,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    sintetico,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    sintetico_back,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    FH_RBench,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">LI_normal =</span> FH_RBench <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(FH_MSE),</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">LS_normal =</span> FH_RBench <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(FH_MSE),</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">LI_logit =</span> <span class="fu">ICL</span>(FH_RBench, FH_MSE)[, <span class="dv">1</span>],</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">LS_logit =</span> <span class="fu">ICL</span>(FH_RBench, FH_MSE)[, <span class="dv">2</span>],</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">LI_final =</span> <span class="fu">ifelse</span>(LI_normal <span class="sc">&lt;</span> <span class="dv">0</span>, LI_logit, LI_normal),</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">LS_final =</span> <span class="fu">ifelse</span>(LS_normal <span class="sc">&gt;</span> <span class="dv">1</span>, LS_logit, LS_normal)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(<span class="fu">head</span>(TablaFinal,<span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> id_dominio </th>
   <th style="text-align:right;"> n_muestral </th>
   <th style="text-align:right;"> Directo </th>
   <th style="text-align:right;"> ee_directo </th>
   <th style="text-align:right;"> CV_directo </th>
   <th style="text-align:right;"> FayHerriot </th>
   <th style="text-align:right;"> rmse_FH </th>
   <th style="text-align:right;"> rrmse_FH </th>
   <th style="text-align:right;"> Gamma </th>
   <th style="text-align:right;"> sintetico </th>
   <th style="text-align:right;"> sintetico_back </th>
   <th style="text-align:right;"> FH_RBench </th>
   <th style="text-align:right;"> LI_normal </th>
   <th style="text-align:right;"> LS_normal </th>
   <th style="text-align:right;"> LI_logit </th>
   <th style="text-align:right;"> LS_logit </th>
   <th style="text-align:right;"> LI_final </th>
   <th style="text-align:right;"> LS_final </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 0101 </td>
   <td style="text-align:right;"> 2951 </td>
   <td style="text-align:right;"> 0.4147 </td>
   <td style="text-align:right;"> 0.0221 </td>
   <td style="text-align:right;"> 0.0534 </td>
   <td style="text-align:right;"> 0.4142 </td>
   <td style="text-align:right;"> 0.0205 </td>
   <td style="text-align:right;"> 0.0496 </td>
   <td style="text-align:right;"> 0.1207 </td>
   <td style="text-align:right;"> 0.6990762 </td>
   <td style="text-align:right;"> 0.4141062 </td>
   <td style="text-align:right;"> 0.4118 </td>
   <td style="text-align:right;"> 0.3716 </td>
   <td style="text-align:right;"> 0.4521 </td>
   <td style="text-align:right;"> 0.3722 </td>
   <td style="text-align:right;"> 0.4526 </td>
   <td style="text-align:right;"> 0.3716 </td>
   <td style="text-align:right;"> 0.4521 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0201 </td>
   <td style="text-align:right;"> 221 </td>
   <td style="text-align:right;"> 0.4526 </td>
   <td style="text-align:right;"> 0.0730 </td>
   <td style="text-align:right;"> 0.1613 </td>
   <td style="text-align:right;"> 0.5390 </td>
   <td style="text-align:right;"> 0.0413 </td>
   <td style="text-align:right;"> 0.0766 </td>
   <td style="text-align:right;"> 0.0128 </td>
   <td style="text-align:right;"> 0.8255541 </td>
   <td style="text-align:right;"> 0.5401128 </td>
   <td style="text-align:right;"> 0.5304 </td>
   <td style="text-align:right;"> 0.4494 </td>
   <td style="text-align:right;"> 0.6113 </td>
   <td style="text-align:right;"> 0.4493 </td>
   <td style="text-align:right;"> 0.6098 </td>
   <td style="text-align:right;"> 0.4494 </td>
   <td style="text-align:right;"> 0.6113 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0202 </td>
   <td style="text-align:right;"> 86 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0.6466 </td>
   <td style="text-align:right;"> 0.0714 </td>
   <td style="text-align:right;"> 0.1104 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0.9341945 </td>
   <td style="text-align:right;"> 0.6466097 </td>
   <td style="text-align:right;"> 0.6362 </td>
   <td style="text-align:right;"> 0.4964 </td>
   <td style="text-align:right;"> 0.7761 </td>
   <td style="text-align:right;"> 0.4887 </td>
   <td style="text-align:right;"> 0.7620 </td>
   <td style="text-align:right;"> 0.4964 </td>
   <td style="text-align:right;"> 0.7761 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0203 </td>
   <td style="text-align:right;"> 86 </td>
   <td style="text-align:right;"> 0.7138 </td>
   <td style="text-align:right;"> 0.1004 </td>
   <td style="text-align:right;"> 0.1406 </td>
   <td style="text-align:right;"> 0.7917 </td>
   <td style="text-align:right;"> 0.0540 </td>
   <td style="text-align:right;"> 0.0682 </td>
   <td style="text-align:right;"> 0.0056 </td>
   <td style="text-align:right;"> 1.0973752 </td>
   <td style="text-align:right;"> 0.7921244 </td>
   <td style="text-align:right;"> 0.7790 </td>
   <td style="text-align:right;"> 0.6732 </td>
   <td style="text-align:right;"> 0.8847 </td>
   <td style="text-align:right;"> 0.6560 </td>
   <td style="text-align:right;"> 0.8669 </td>
   <td style="text-align:right;"> 0.6732 </td>
   <td style="text-align:right;"> 0.8847 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0204 </td>
   <td style="text-align:right;"> 51 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0.7472 </td>
   <td style="text-align:right;"> 0.0726 </td>
   <td style="text-align:right;"> 0.0972 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 1.0439193 </td>
   <td style="text-align:right;"> 0.7471556 </td>
   <td style="text-align:right;"> 0.7352 </td>
   <td style="text-align:right;"> 0.5928 </td>
   <td style="text-align:right;"> 0.8775 </td>
   <td style="text-align:right;"> 0.5720 </td>
   <td style="text-align:right;"> 0.8522 </td>
   <td style="text-align:right;"> 0.5928 </td>
   <td style="text-align:right;"> 0.8775 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0205 </td>
   <td style="text-align:right;"> 34 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0.7119 </td>
   <td style="text-align:right;"> 0.1019 </td>
   <td style="text-align:right;"> 0.1431 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 1.0041934 </td>
   <td style="text-align:right;"> 0.7118791 </td>
   <td style="text-align:right;"> 0.7005 </td>
   <td style="text-align:right;"> 0.5008 </td>
   <td style="text-align:right;"> 0.9002 </td>
   <td style="text-align:right;"> 0.4745 </td>
   <td style="text-align:right;"> 0.8583 </td>
   <td style="text-align:right;"> 0.5008 </td>
   <td style="text-align:right;"> 0.9002 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0206 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:right;"> 0.5527 </td>
   <td style="text-align:right;"> 0.1154 </td>
   <td style="text-align:right;"> 0.2088 </td>
   <td style="text-align:right;"> 0.5870 </td>
   <td style="text-align:right;"> 0.0638 </td>
   <td style="text-align:right;"> 0.1087 </td>
   <td style="text-align:right;"> 0.0052 </td>
   <td style="text-align:right;"> 0.8730630 </td>
   <td style="text-align:right;"> 0.5872164 </td>
   <td style="text-align:right;"> 0.5776 </td>
   <td style="text-align:right;"> 0.4526 </td>
   <td style="text-align:right;"> 0.7027 </td>
   <td style="text-align:right;"> 0.4503 </td>
   <td style="text-align:right;"> 0.6954 </td>
   <td style="text-align:right;"> 0.4526 </td>
   <td style="text-align:right;"> 0.7027 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0208 </td>
   <td style="text-align:right;"> 74 </td>
   <td style="text-align:right;"> 0.8122 </td>
   <td style="text-align:right;"> 0.0983 </td>
   <td style="text-align:right;"> 0.1210 </td>
   <td style="text-align:right;"> 0.6703 </td>
   <td style="text-align:right;"> 0.0775 </td>
   <td style="text-align:right;"> 0.1156 </td>
   <td style="text-align:right;"> 0.0044 </td>
   <td style="text-align:right;"> 0.9584522 </td>
   <td style="text-align:right;"> 0.6696196 </td>
   <td style="text-align:right;"> 0.6595 </td>
   <td style="text-align:right;"> 0.5077 </td>
   <td style="text-align:right;"> 0.8114 </td>
   <td style="text-align:right;"> 0.4962 </td>
   <td style="text-align:right;"> 0.7921 </td>
   <td style="text-align:right;"> 0.5077 </td>
   <td style="text-align:right;"> 0.8114 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0210 </td>
   <td style="text-align:right;"> 16 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0.7081 </td>
   <td style="text-align:right;"> 0.1037 </td>
   <td style="text-align:right;"> 0.1465 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 1.0000249 </td>
   <td style="text-align:right;"> 0.7080961 </td>
   <td style="text-align:right;"> 0.6967 </td>
   <td style="text-align:right;"> 0.4935 </td>
   <td style="text-align:right;"> 0.9000 </td>
   <td style="text-align:right;"> 0.4675 </td>
   <td style="text-align:right;"> 0.8574 </td>
   <td style="text-align:right;"> 0.4935 </td>
   <td style="text-align:right;"> 0.9000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0301 </td>
   <td style="text-align:right;"> 264 </td>
   <td style="text-align:right;"> 0.5668 </td>
   <td style="text-align:right;"> 0.0624 </td>
   <td style="text-align:right;"> 0.1100 </td>
   <td style="text-align:right;"> 0.5305 </td>
   <td style="text-align:right;"> 0.0362 </td>
   <td style="text-align:right;"> 0.0683 </td>
   <td style="text-align:right;"> 0.0170 </td>
   <td style="text-align:right;"> 0.8152491 </td>
   <td style="text-align:right;"> 0.5298332 </td>
   <td style="text-align:right;"> 0.5220 </td>
   <td style="text-align:right;"> 0.4509 </td>
   <td style="text-align:right;"> 0.5930 </td>
   <td style="text-align:right;"> 0.4510 </td>
   <td style="text-align:right;"> 0.5921 </td>
   <td style="text-align:right;"> 0.4509 </td>
   <td style="text-align:right;"> 0.5930 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0302 </td>
   <td style="text-align:right;"> 123 </td>
   <td style="text-align:right;"> 0.7561 </td>
   <td style="text-align:right;"> 0.0769 </td>
   <td style="text-align:right;"> 0.1017 </td>
   <td style="text-align:right;"> 0.6841 </td>
   <td style="text-align:right;"> 0.0630 </td>
   <td style="text-align:right;"> 0.0921 </td>
   <td style="text-align:right;"> 0.0085 </td>
   <td style="text-align:right;"> 0.9733220 </td>
   <td style="text-align:right;"> 0.6835305 </td>
   <td style="text-align:right;"> 0.6732 </td>
   <td style="text-align:right;"> 0.5496 </td>
   <td style="text-align:right;"> 0.7967 </td>
   <td style="text-align:right;"> 0.5402 </td>
   <td style="text-align:right;"> 0.7832 </td>
   <td style="text-align:right;"> 0.5496 </td>
   <td style="text-align:right;"> 0.7967 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0303 </td>
   <td style="text-align:right;"> 206 </td>
   <td style="text-align:right;"> 0.6078 </td>
   <td style="text-align:right;"> 0.0684 </td>
   <td style="text-align:right;"> 0.1125 </td>
   <td style="text-align:right;"> 0.6168 </td>
   <td style="text-align:right;"> 0.0353 </td>
   <td style="text-align:right;"> 0.0572 </td>
   <td style="text-align:right;"> 0.0139 </td>
   <td style="text-align:right;"> 0.9033845 </td>
   <td style="text-align:right;"> 0.6168944 </td>
   <td style="text-align:right;"> 0.6069 </td>
   <td style="text-align:right;"> 0.5377 </td>
   <td style="text-align:right;"> 0.6761 </td>
   <td style="text-align:right;"> 0.5360 </td>
   <td style="text-align:right;"> 0.6735 </td>
   <td style="text-align:right;"> 0.5377 </td>
   <td style="text-align:right;"> 0.6761 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0304 </td>
   <td style="text-align:right;"> 176 </td>
   <td style="text-align:right;"> 0.6450 </td>
   <td style="text-align:right;"> 0.0716 </td>
   <td style="text-align:right;"> 0.1110 </td>
   <td style="text-align:right;"> 0.7021 </td>
   <td style="text-align:right;"> 0.0503 </td>
   <td style="text-align:right;"> 0.0717 </td>
   <td style="text-align:right;"> 0.0121 </td>
   <td style="text-align:right;"> 0.9942169 </td>
   <td style="text-align:right;"> 0.7028011 </td>
   <td style="text-align:right;"> 0.6908 </td>
   <td style="text-align:right;"> 0.5922 </td>
   <td style="text-align:right;"> 0.7895 </td>
   <td style="text-align:right;"> 0.5847 </td>
   <td style="text-align:right;"> 0.7800 </td>
   <td style="text-align:right;"> 0.5922 </td>
   <td style="text-align:right;"> 0.7895 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0305 </td>
   <td style="text-align:right;"> 51 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0.6842 </td>
   <td style="text-align:right;"> 0.0729 </td>
   <td style="text-align:right;"> 0.1066 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0.9740382 </td>
   <td style="text-align:right;"> 0.6841966 </td>
   <td style="text-align:right;"> 0.6732 </td>
   <td style="text-align:right;"> 0.5303 </td>
   <td style="text-align:right;"> 0.8162 </td>
   <td style="text-align:right;"> 0.5183 </td>
   <td style="text-align:right;"> 0.7978 </td>
   <td style="text-align:right;"> 0.5303 </td>
   <td style="text-align:right;"> 0.8162 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0401 </td>
   <td style="text-align:right;"> 481 </td>
   <td style="text-align:right;"> 0.5419 </td>
   <td style="text-align:right;"> 0.0455 </td>
   <td style="text-align:right;"> 0.0840 </td>
   <td style="text-align:right;"> 0.5609 </td>
   <td style="text-align:right;"> 0.0352 </td>
   <td style="text-align:right;"> 0.0627 </td>
   <td style="text-align:right;"> 0.0319 </td>
   <td style="text-align:right;"> 0.8471080 </td>
   <td style="text-align:right;"> 0.5615533 </td>
   <td style="text-align:right;"> 0.5519 </td>
   <td style="text-align:right;"> 0.4830 </td>
   <td style="text-align:right;"> 0.6209 </td>
   <td style="text-align:right;"> 0.4825 </td>
   <td style="text-align:right;"> 0.6194 </td>
   <td style="text-align:right;"> 0.4830 </td>
   <td style="text-align:right;"> 0.6209 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0402 </td>
   <td style="text-align:right;"> 75 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0.7460 </td>
   <td style="text-align:right;"> 0.0684 </td>
   <td style="text-align:right;"> 0.0916 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 1.0426203 </td>
   <td style="text-align:right;"> 0.7460256 </td>
   <td style="text-align:right;"> 0.7341 </td>
   <td style="text-align:right;"> 0.6001 </td>
   <td style="text-align:right;"> 0.8680 </td>
   <td style="text-align:right;"> 0.5815 </td>
   <td style="text-align:right;"> 0.8458 </td>
   <td style="text-align:right;"> 0.6001 </td>
   <td style="text-align:right;"> 0.8680 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0403 </td>
   <td style="text-align:right;"> 108 </td>
   <td style="text-align:right;"> 0.6788 </td>
   <td style="text-align:right;"> 0.0913 </td>
   <td style="text-align:right;"> 0.1345 </td>
   <td style="text-align:right;"> 0.6959 </td>
   <td style="text-align:right;"> 0.0598 </td>
   <td style="text-align:right;"> 0.0859 </td>
   <td style="text-align:right;"> 0.0072 </td>
   <td style="text-align:right;"> 0.9868279 </td>
   <td style="text-align:right;"> 0.6960252 </td>
   <td style="text-align:right;"> 0.6847 </td>
   <td style="text-align:right;"> 0.5676 </td>
   <td style="text-align:right;"> 0.8019 </td>
   <td style="text-align:right;"> 0.5580 </td>
   <td style="text-align:right;"> 0.7889 </td>
   <td style="text-align:right;"> 0.5676 </td>
   <td style="text-align:right;"> 0.8019 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0404 </td>
   <td style="text-align:right;"> 68 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0.5999 </td>
   <td style="text-align:right;"> 0.0754 </td>
   <td style="text-align:right;"> 0.1257 </td>
   <td style="text-align:right;"> NA </td>
   <td style="text-align:right;"> 0.8859597 </td>
   <td style="text-align:right;"> 0.5998849 </td>
   <td style="text-align:right;"> 0.5903 </td>
   <td style="text-align:right;"> 0.4425 </td>
   <td style="text-align:right;"> 0.7381 </td>
   <td style="text-align:right;"> 0.4388 </td>
   <td style="text-align:right;"> 0.7263 </td>
   <td style="text-align:right;"> 0.4425 </td>
   <td style="text-align:right;"> 0.7381 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0405 </td>
   <td style="text-align:right;"> 221 </td>
   <td style="text-align:right;"> 0.5383 </td>
   <td style="text-align:right;"> 0.0704 </td>
   <td style="text-align:right;"> 0.1309 </td>
   <td style="text-align:right;"> 0.5777 </td>
   <td style="text-align:right;"> 0.0513 </td>
   <td style="text-align:right;"> 0.0889 </td>
   <td style="text-align:right;"> 0.0136 </td>
   <td style="text-align:right;"> 0.8639324 </td>
   <td style="text-align:right;"> 0.5782117 </td>
   <td style="text-align:right;"> 0.5684 </td>
   <td style="text-align:right;"> 0.4678 </td>
   <td style="text-align:right;"> 0.6690 </td>
   <td style="text-align:right;"> 0.4664 </td>
   <td style="text-align:right;"> 0.6649 </td>
   <td style="text-align:right;"> 0.4678 </td>
   <td style="text-align:right;"> 0.6690 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 0407 </td>
   <td style="text-align:right;"> 67 </td>
   <td style="text-align:right;"> 0.7513 </td>
   <td style="text-align:right;"> 0.1113 </td>
   <td style="text-align:right;"> 0.1482 </td>
   <td style="text-align:right;"> 0.6447 </td>
   <td style="text-align:right;"> 0.0677 </td>
   <td style="text-align:right;"> 0.1050 </td>
   <td style="text-align:right;"> 0.0042 </td>
   <td style="text-align:right;"> 0.9317482 </td>
   <td style="text-align:right;"> 0.6442693 </td>
   <td style="text-align:right;"> 0.6344 </td>
   <td style="text-align:right;"> 0.5017 </td>
   <td style="text-align:right;"> 0.7671 </td>
   <td style="text-align:right;"> 0.4948 </td>
   <td style="text-align:right;"> 0.7546 </td>
   <td style="text-align:right;"> 0.5017 </td>
   <td style="text-align:right;"> 0.7671 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Comparando los limites superior e inferior de los IC</p>
<div class="cell" data-hash="0Recursos/05/unnamed-chunk-11_2803e2aa19265cc2ea14948cfc8397d1">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(TablaFinal, <span class="fu">aes</span>(<span class="at">x =</span> LI_normal, <span class="at">y =</span> LI_logit)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="dv">2</span>)  <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"LI_logit"</span>, <span class="at">x =</span> <span class="st">"LI"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(TablaFinal, <span class="fu">aes</span>(<span class="at">x =</span> LS_normal, <span class="at">y =</span> LS_logit)) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="dv">2</span>)  <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"LS_logit"</span>, <span class="at">x =</span> <span class="st">"LS"</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>a1 <span class="sc">|</span> a2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/05/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Guardar resultados</p>
<div class="cell" data-hash="0Recursos/05/unnamed-chunk-12_4f67cb5f32b4b4e7d531b6bf39ef3a17">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(TablaFinal, <span class="st">'../Data/TablaFinal.Rds'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(estimacionesBench, <span class="st">'../Data/estimacionesBench.Rds'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="creando-mapa-de-resultados" class="level2">
<h2 class="anchored" data-anchor-id="creando-mapa-de-resultados">Creando mapa de resultados</h2>
<p>La función <code>tm_shape()</code> de la librería <code>tmap</code> se utiliza para especificar los datos espaciales (mapa) que se van a <code>graficar</code>. En este caso, se le pasa como argumento la tabla <code>poligonos_dominios</code>.</p>
<p>La función <code>tm_fill()</code> se utiliza para definir el estilo de relleno de los polígonos en el mapa. En este caso, se utiliza para graficar la variable <code>fh_porc</code>. Se utiliza el estilo “quantile” para que se dividan los valores en cuantiles y se apliquen diferentes tonalidades de color para cada cuantil.</p>
<p>La función <code>tm_borders()</code> se utiliza para especificar las propiedades de las líneas que delinean los polígonos.</p>
<p>La función <code>tm_layout()</code> se utiliza para definir los elementos del diseño del mapa, como la posición y estilo de la leyenda. En este caso, se define que la leyenda se ubique en la parte inferior central del mapa, que el fondo de la leyenda sea blanco con transparencia del 10%, y se especifica el tamaño del texto de la leyenda.</p>
<div class="cell" data-hash="0Recursos/05/unnamed-chunk-13_1f74050febfd80ad4a2f232458f6f68e">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>poligonos_dominios <span class="ot">&lt;-</span> poligonos_dominios <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>( temp_Bench, <span class="at">by =</span> id_dominio ) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">fh_porc =</span> FH_RBench )</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>mapa <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>( poligonos_dominios ) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>( <span class="st">"fh_porc"</span>, <span class="at">style =</span> <span class="st">"quantile"</span>, <span class="at">title=</span><span class="st">"Tasa de informalidad"</span> ) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>( <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">lty =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>( <span class="co">#"Wealth (or so)",</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.size =</span> <span class="fl">0.6</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>( <span class="st">"center"</span>,<span class="st">"bottom"</span> ),</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.bg.color =</span> <span class="st">"white"</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.stack =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#legend.digits = 5,</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.bg.alpha =</span> <span class="fl">0.1</span>) </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>mapa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/05/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>